# PHP-0817 Exploit

I have written another include system for my dynamic webpages, but it seems to be vulnerable to LFI.
Here is the code:

```php
<?php
if (isset($_GET['which']))
{
        $which = $_GET['which'];
        switch ($which)
        {
        case 0:
        case 1:
        case 2:
                require_once $which.'.php';
                break;
        default:
                echo GWF_HTML::error('PHP-0817', 'Hacker NoNoNo!', false);
                break;
        }
}
?>
```
Your mission is to include [solution.php](http://www.wechall.net/challenge/php0817/solution.php).
Here is the script in action: [News](http://www.wechall.net/challenge/php0817/index.php?which=0), [Forum](http://www.wechall.net/challenge/php0817/index.php?which=1), [Guestbook](http://www.wechall.net/challenge/php0817/index.php?which=2).

## Solution

[LFI: Local FIle Inclusion](file:///C:/Users/WU/Downloads/PHP_LFI_rfc1867_temporary_files.pdf)
文件包含通常又有本地文件包含（Local File Inclusion）和远程文件包含(Remote File Inclusion)之分。allow_url_fopen和allow_url_include是决定包含属于本地文件包含（LFI）还是远程文件包含 （RFI）的条件，在PHP4中则只有一个allow_url_fopen选择。其中allow_url_fopen和 allow_url_include为0n的情况为远程文件包含漏洞，相反为本地文件包含漏洞。
